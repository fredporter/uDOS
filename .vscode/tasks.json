{
	"version": "2.0.0",
	"tasks": [
		{
			"label": "Check Virtual Environment",
			"type": "shell",
			"command": "bash",
			"args": [
				"-c",
				"if [ -z \"$VIRTUAL_ENV\" ]; then echo \"WARN: Virtual environment not active! Run: source .venv/bin/activate\"; exit 1; else echo \"OK: Virtual environment active: $VIRTUAL_ENV\"; fi"
			],
			"group": "build",
			"presentation": {
				"reveal": "always",
				"panel": "shared"
			},
			"problemMatcher": []
		},
		{
			"label": "Run uDOS Interactive",
			"type": "shell",
			"command": "${workspaceFolder}/bin/udos",
			"group": {
				"kind": "build",
				"isDefault": true
			},
			"presentation": {
				"reveal": "always",
				"panel": "dedicated",
				"focus": true,
				"clear": true
			},
			"dependsOn": "Check Virtual Environment",
			"problemMatcher": []
		},
		{
			"label": "Run Shakedown Test",
			"type": "shell",
			"command": "/bin/bash",
			"args": [
				"-lc",
				"if [ -z \"$VIRTUAL_ENV\" ]; then echo \"WARN: Virtual environment not active! Run: source .venv/bin/activate\"; exit 1; else echo \"OK: Virtual environment active: $VIRTUAL_ENV\"; fi; if [ -n \"$VIRTUAL_ENV\" ] && [ -x \"$VIRTUAL_ENV/bin/python\" ]; then PYTHON=\"$VIRTUAL_ENV/bin/python\"; else PYTHON=python; fi; if [ -f memory/tests/shakedown-script.md ]; then ./bin/udos memory/tests/shakedown-script.md; else $PYTHON -m pytest memory/tests/test_shakedown_destroy_v1_1_0.py; fi"
			],
			"group": {
				"kind": "test",
				"isDefault": true
			},
			"presentation": {
				"reveal": "always",
				"panel": "dedicated",
				"focus": true,
				"clear": true
			},
			"problemMatcher": []
		},
		{
			"label": "Run TypeScript Standalone Tests",
			"type": "shell",
			"command": "${workspaceFolder}/.venv/bin/python",
			"args": [
				"${workspaceFolder}/memory/tests/test_v1_0_2_standalone.py"
			],
			"group": "test",
			"presentation": {
				"reveal": "always",
				"panel": "new",
				"clear": true
			},
			"dependsOn": "Check Virtual Environment",
			"problemMatcher": []
		},
		{
			"label": "Run TypeScript Integration Tests",
			"type": "shell",
			"command": "${workspaceFolder}/.venv/bin/python",
			"args": [
				"${workspaceFolder}/memory/tests/integration/test_v1_0_2_integration.py"
			],
			"group": "test",
			"presentation": {
				"reveal": "always",
				"panel": "new",
				"clear": true
			},
			"dependsOn": "Check Virtual Environment",
			"problemMatcher": []
		},
		{
			"label": "Wizard: Run MCP (stdio)",
			"type": "process",
			"command": "${workspaceFolder}/.venv-mcp/bin/python",
			"args": [
				"${workspaceFolder}/mcp/wizard/mcp_server.py"
			],
			"presentation": {
				"reveal": "always",
				"panel": "dedicated",
				"focus": true,
				"clear": true
			},
			"problemMatcher": []
		},
		{
			"label": "Wizard: Run Server (interactive, auto-port)",
			"type": "shell",
			"command": "/bin/bash",
			"args": [
				"-lc",
				"PORT=$(${workspaceFolder}/.venv/bin/python -m wizard.cli_port_manager available 9000 | tr -cd \"0-9\"); ${workspaceFolder}/.venv/bin/python -m wizard.cli_port_manager reassign wizard $PORT >/dev/null; echo \"$PORT\" > ${workspaceFolder}/.wizard-port; echo \"Wizard port: $PORT\"; PYTHONPATH=\"${workspaceFolder}\" ${workspaceFolder}/.venv/bin/python -m wizard.server --port $PORT"
			],
			"isBackground": true,
			"presentation": {
				"reveal": "always",
				"panel": "dedicated",
				"focus": false,
				"clear": true
			},
			"problemMatcher": []
		},
		{
			"label": "Dashboard: Build (file, api base)",
			"type": "shell",
			"command": "/bin/bash",
			"args": [
				"-lc",
				"PORT=$(cat ${workspaceFolder}/.wizard-port 2>/dev/null || echo 8765); VITE_WIZARD_API_BASE=\"http://localhost:$PORT\" npm -C ${workspaceFolder}/wizard/dashboard run build"
			],
			"presentation": {
				"reveal": "always",
				"panel": "shared",
				"focus": false,
				"clear": true
			},
			"problemMatcher": []
		},
		{
			"label": "Dashboard: Serve dist (http)",
			"type": "shell",
			"command": "/bin/bash",
			"args": [
				"-lc",
				"PORT=$(${workspaceFolder}/.venv/bin/python -m wizard.cli_port_manager available 9100 | tr -cd \"0-9\"); echo \"$PORT\" > ${workspaceFolder}/.dashboard-port; echo \"Dashboard port: $PORT\"; cd ${workspaceFolder}/wizard/dashboard/dist && python -m http.server $PORT"
			],
			"isBackground": true,
			"presentation": {
				"reveal": "always",
				"panel": "dedicated",
				"focus": false,
				"clear": true
			},
			"problemMatcher": []
		},
		{
			"label": "Dashboard: Reset API Base",
			"type": "shell",
			"command": "/bin/bash",
			"args": [
				"-lc",
				"PORT=$(cat ${workspaceFolder}/.dashboard-port 2>/dev/null || echo 9100); open \"http://localhost:$PORT/reset.html\""
			],
			"presentation": {
				"reveal": "always",
				"panel": "shared",
				"focus": false,
				"clear": true
			},
			"problemMatcher": []
		},
		{
			"label": "Dashboard: Open (Wizard HTTP)",
			"type": "shell",
			"command": "/bin/bash",
			"args": [
				"-lc",
				"PORT=$(cat ${workspaceFolder}/.wizard-port 2>/dev/null || echo 8765); open \"http://localhost:$PORT/\""
			],
			"presentation": {
				"reveal": "always",
				"panel": "shared",
				"focus": false,
				"clear": true
			},
			"problemMatcher": []
		},
		{
			"label": "Dashboard: Open (Static HTTP)",
			"type": "shell",
			"command": "/bin/bash",
			"args": [
				"-lc",
				"PORT=$(cat ${workspaceFolder}/.dashboard-port 2>/dev/null || echo 9100); open \"http://localhost:$PORT/index.html\""
			],
			"presentation": {
				"reveal": "always",
				"panel": "shared",
				"focus": false,
				"clear": true
			},
			"problemMatcher": []
		},
		{
			"label": "uCODE: Dispatch Command",
			"type": "shell",
			"command": "/bin/bash",
			"args": [
				"-lc",
				"PORT=$(cat ${workspaceFolder}/.wizard-port 2>/dev/null || echo 8765); curl -sS -H \"Authorization: Bearer $WIZARD_ADMIN_TOKEN\" -H \"Content-Type: application/json\" -d '{\"command\": \"${input:ucodeCommand}\"}' http://localhost:$PORT/api/ucode/dispatch"
			],
			"presentation": {
				"reveal": "always",
				"panel": "shared",
				"focus": false,
				"clear": true
			},
			"problemMatcher": []
		},
		{
			"label": "Shell: Run Command",
			"type": "shell",
			"command": "/bin/bash",
			"args": [
				"-lc",
				"${input:shellCommand}"
			],
			"presentation": {
				"reveal": "always",
				"panel": "shared",
				"focus": true,
				"clear": true
			},
			"problemMatcher": []
		},
		{
			"label": "Vibe Chat (interactive)",
			"type": "shell",
			"command": "vibe",
			"args": [
				"chat"
			],
			"presentation": {
				"reveal": "always",
				"panel": "dedicated",
				"focus": true,
				"clear": true
			},
			"problemMatcher": []
		},
		{
			"label": "Vibe Chat (prompt)",
			"type": "shell",
			"command": "bash",
			"args": [
				"-c",
				"vibe chat \"${input:vibePrompt}\""
			],
			"presentation": {
				"reveal": "always",
				"panel": "dedicated",
				"focus": true,
				"clear": true
			},
			"problemMatcher": []
		},
		{
			"label": "Vibe Chat (with context)",
			"type": "shell",
			"command": "bash",
			"args": [
				"-c",
				"vibe chat --with-context \"${input:vibePrompt}\""
			],
			"presentation": {
				"reveal": "always",
				"panel": "dedicated",
				"focus": true,
				"clear": true
			},
			"problemMatcher": []
		},
		{
			"label": "Vibe Chat (with context, stream)",
			"type": "shell",
			"command": "bash",
			"args": [
				"-c",
				"vibe chat --with-context --stream \"${input:vibePrompt}\""
			],
			"presentation": {
				"reveal": "always",
				"panel": "dedicated",
				"focus": true,
				"clear": true
			},
			"problemMatcher": []
		},
		{
			"label": "Vibe Chat (model)",
			"type": "shell",
			"command": "bash",
			"args": [
				"-c",
				"vibe chat --model \"${input:vibeModel}\" \"${input:vibePrompt}\""
			],
			"presentation": {
				"reveal": "always",
				"panel": "dedicated",
				"focus": true,
				"clear": true
			},
			"problemMatcher": []
		},
		{
			"label": "Vibe Chat (with context, model, stream)",
			"type": "shell",
			"command": "bash",
			"args": [
				"-c",
				"vibe chat --with-context --stream --model \"${input:vibeModel}\" \"${input:vibePrompt}\""
			],
			"presentation": {
				"reveal": "always",
				"panel": "dedicated",
				"focus": true,
				"clear": true
			},
			"problemMatcher": []
		},
		{
			"label": "Check Git Reflog",
			"type": "shell",
			"command": "git reflog --all | head -30"
		},
		{
			"label": "Show All Commits",
			"type": "shell",
			"command": "git log --oneline --all --graph | head -40"
		},
		{
			"label": "Find TUI Related Commits",
			"type": "shell",
			"command": "git reflog show --all 2>&1 | grep -E '(TUI|form|render|selector|input)' | head -20"
		},
		{
			"label": "Search TUI Commits",
			"type": "shell",
			"command": "git log --all --oneline --grep='TUI\\|form\\|render\\|selector\\|input' | head -30"
		},
		{
			"label": "Find Lost Commit",
			"type": "shell",
			"command": "git show 2cf5d9f --stat 2>&1 || git reflog | grep '2cf5d9f' || git log --all --oneline | grep '2cf5d9f'"
		},
		{
			"label": "Check Stashes",
			"type": "shell",
			"command": "git stash list"
		},
		{
			"label": "Check Stash 0",
			"type": "shell",
			"command": "git stash show -p stash@{0} --stat | head -50"
		},
		{
			"label": "Stash 0 Files",
			"type": "shell",
			"command": "git stash show stash@{0} --name-only"
		},
		{
			"label": "Recover TUI Changes",
			"type": "shell",
			"command": "git stash pop stash@{0}"
		},
		{
			"label": "Commit and Push TUI Work",
			"type": "shell",
			"command": "git add core/tui/form_fields.py core/tui/story_form_handler.py core/grid-runtime/src/index.ts && git commit -m \"feat: Enhance TUI form rendering with proper ANSI display width handling\n\n- Fix display width calculations in form_fields.py to handle ANSI codes\n- Add BarSelector and LocationSelector boxed styling\n- Improve DatePicker, TimePicker, and DateTimeApproval rendering\n- Add alternate screen buffer support in story_form_handler.py\n- Better keyboard navigation (arrow keys now inc/dec values)\n- Add CHECKBOX field type support\n- Fix TextInput field rendering and input handling\n- Improve logging for debugging TUI interactions\" && git push origin main"
		},
		{
			"label": "Check Status",
			"type": "shell",
			"command": "git status"
		},
		{
			"label": "Checkout Main",
			"type": "shell",
			"command": "git checkout main && git status"
		},
		{
			"label": "Check Remaining Stashes",
			"type": "shell",
			"command": "git stash list"
		},
		{
			"label": "Check Last Stash",
			"type": "shell",
			"command": "git stash show stash@{0} --name-only"
		},
		{
			"label": "Find Stash Pop",
			"type": "shell",
			"command": "git reflog | grep -E 'stash|pop' | head -10"
		},
		{
			"label": "Find TUI in Reflog",
			"type": "shell",
			"command": "git reflog --all | grep -B2 -A2 'form_fields\\|story_form' | head -20"
		},
		{
			"label": "Check Recent Diffs",
			"type": "shell",
			"command": "git diff HEAD@{1} HEAD -- core/tui/form_fields.py core/tui/story_form_handler.py | head -50"
		},
		{
			"label": "Recover from HEAD@{1}",
			"type": "shell",
			"command": "git show HEAD@{1}:core/tui/form_fields.py > /tmp/form_fields_recovered.py && git show HEAD@{1}:core/tui/story_form_handler.py > /tmp/story_form_handler_recovered.py && git show HEAD@{1}:core/grid-runtime/src/index.ts > /tmp/index_recovered.ts && echo 'Files recovered to /tmp'"
		},
		{
			"label": "Restore TUI Files",
			"type": "shell",
			"command": "cp /tmp/form_fields_recovered.py core/tui/form_fields.py && cp /tmp/story_form_handler_recovered.py core/tui/story_form_handler.py && cp /tmp/index_recovered.ts core/grid-runtime/src/index.ts && git diff --stat"
		},
		{
			"label": "Commit and Push TUI",
			"type": "shell",
			"command": "git add core/tui/form_fields.py core/tui/story_form_handler.py core/grid-runtime/src/index.ts && git commit -m 'feat: Enhance TUI form rendering\n\n- Fix ANSI display width calculations\n- Add boxed styling for selectors\n- Improve keyboard navigation\n- Add CHECKBOX field type\n- Add alternate screen buffer support' && git push origin main"
		},
		{
			"label": "Commit TUI Work",
			"type": "shell",
			"command": "git add core/tui/form_fields.py core/tui/story_form_handler.py core/grid-runtime/src/index.ts && git commit -m 'feat: enhance TUI form rendering and keyboard navigation' && git push origin main"
		},
		{
			"label": "Final Commit",
			"type": "shell",
			"command": "cp /tmp/form_fields_recovered.py core/tui/form_fields.py && cp /tmp/story_form_handler_recovered.py core/tui/story_form_handler.py && cp /tmp/index_recovered.ts core/grid-runtime/src/index.ts && git add -A && git commit -m 'feat: enhance TUI form rendering' && git push"
		}
	],
	"inputs": [
		{
			"id": "vibePrompt",
			"type": "promptString",
			"description": "Vibe prompt",
			"default": "What is uDOS?"
		},
		{
			"id": "vibeModel",
			"type": "promptString",
			"description": "Vibe model",
			"default": "devstral-small"
		},
		{
			"id": "ucodeCommand",
			"type": "promptString",
			"description": "uCODE command (allowlisted or raw)",
			"default": "STATUS"
		},
		{
			"id": "shellCommand",
			"type": "promptString",
			"description": "Shell command",
			"default": "ls -la"
		}
	]
}