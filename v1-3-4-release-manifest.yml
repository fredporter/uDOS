v1.3.4-release-manifest.yml

# uDOS v1.3.4 — Physical Systems Release Manifest
# Alpine Baremetal: Diskless + Persistent Overlay, OpenRC, Wayland/Cage, Tier Selection

release_info:
  version: 1.3.4
  codename: "Physical Systems"
  release_date: "2026-02-05"
  status: "provisioning"
  target_platform: "Alpine Linux (diskless)"
  tier: "v1.3 → v1.3.4"

description: |
  Alpine baremetal provisioning system with:
  - Diskless + persistent overlay architecture
  - Dual-tier system (Tier 1: TUI / Tier 2: GUI)
  - OpenRC service management
  - Wayland + Cage single-app compositor
  - Tauri GUI application packaging
  - Automatic recovery/failure handling

components:
  core:
    name: uDOS Core
    version: "v1.1.0"
    status: "stable"
    features:
      - OS detection (Alpine, macOS, Ubuntu, Windows)
      - Disk operations (mount, format, partition)
      - Service management (OpenRC, systemctl, launchctl)
      - Package management (apk, apt, brew, choco)
    notes: "Alpine-first implementation"

  wizard:
    name: uDOS Wizard Server
    version: "v1.1.1"
    status: "stable"
    features:
      - Web dashboard
      - Plugin management
      - APK builder for Alpine
      - Library manager with Alpine toolchain

  sonic:
    name: uDOS Sonic Screwdriver
    version: "v1.3.1"
    status: "alpha"
    features:
      - USB/ISO image builder
      - Ventoy integration
      - Boot manifests
      - Hardware detection

  app:
    name: uMarkdown App (Tauri)
    version: "v1.0.7"
    status: "alpha"
    features:
      - Markdown editor
      - Vault integration
      - WebView rendering
      - Single-app mode support

  knowledge_bank:
    name: uDOS Knowledge Bank
    version: "v1.1.0"
    status: "alpha"
    features:
      - Static knowledge catalog
      - Markdown reference
      - Plugin documentation

new_deliverables:
  - name: "udos-gui"
    path: "/usr/local/bin/udos-gui"
    type: "launcher script"
    purpose: "Wayland session manager for Tier 2 GUI mode"
    features:
      - Persistence mount verification
      - XDG_RUNTIME_DIR setup
      - seatd lifecycle management
      - Cage + Tauri launching
      - Exit behavior handling
      - Graphics stack checking

  - name: "OpenRC Services"
    location: "/etc/init.d/"
    services:
      - name: "seatd"
        description: "Seat management daemon (Wayland access)"
        depends: "localmount"
      - name: "udos-gui"
        description: "Cage + Tauri GUI session"
        depends: "seatd, localmount"
      - name: "tier-selector"
        description: "Boot-time tier selection (TUI vs GUI)"
        depends: "localmount"
      - name: "udos-watchdog"
        description: "System health monitoring & recovery"
        depends: "localmount"

  - name: "udos-tier"
    path: "/usr/local/bin/udos-tier"
    type: "CLI utility"
    purpose: "Runtime tier management"
    commands:
      - status: "Show current tier and prerequisites"
      - switch: "Switch between TUI and GUI tiers"
      - boot-flags: "Show kernel boot flag configuration"
      - config: "Show configuration locations"

  - name: "udos-persist"
    path: "/usr/local/bin/udos-persist"
    type: "CLI utility"
    purpose: "Persistence partition management"
    commands:
      - check: "Verify partition health"
      - mount: "Mount UDOS_PERSIST"
      - unmount: "Safe unmount"
      - setup: "Initialize new persistence partition"
      - backup: "Create apkovl backup"
      - restore: "Restore from backup"

  - name: "udos-watchdog"
    path: "/usr/local/bin/udos-watchdog"
    type: "CLI utilities + service"
    purpose: "System health monitoring and recovery"
    features:
      - GUI process monitoring
      - Crash count tracking
      - Disk space checking
      - Automatic TUI fallback on failures
      - Recovery event logging
      - Diagnostics reporting

  - name: "Tauri App Package (APKBUILD)"
    path: "/distribution/apkbuild/udos-ui/"
    type: "Alpine package builder"
    produces: "udos-ui APK package"
    features:
      - Dependency resolution
      - Build from uMarkdown-app repository
      - Desktop entry creation
      - Post-install hooks
      - Cross-architecture support (x86_64, aarch64, armhf)

architecture:
  tier_1_tui:
    name: "Text User Interface (Default)"
    boot_path:
      - "Alpine diskless boot"
      - "OpenRC initialization"
      - "TTY shell prompt"
    services:
      - "localmount (filesystem)"
      - "networking (optional)"
      - "logd (logging)"
    features:
      - "Full uDOS CLI access"
      - "Command-driven workflows"
      - "Minimal RAM footprint"
      - "No graphics requirements"

  tier_2_gui:
    name: "Graphical User Interface (Wayland)"
    boot_path:
      - "Alpine diskless boot"
      - "OpenRC initialization"
      - "tier-selector (checks /etc/udos/mode)"
      - "seatd (seat management)"
      - "cage (single-app Wayland compositor)"
      - "Tauri app (udos-ui) launched"
    services:
      - "localmount"
      - "networking (optional)"
      - "seatd"
      - "udos-gui launcher"
      - "udos-watchdog (recovery monitoring)"
    features:
      - "Visual editor"
      - "One-app mode (no window manager)"
      - "Persistent configuration"
      - "Automatic failure recovery"

persistence:
  strategy: "Dedicated UDOS_PERSIST partition + apkovl"
  mount_point: "/mnt/udos"
  partition_format: "ext4"
  partition_label: "UDOS_PERSIST"
  directories:
    apkovl: "/mnt/udos/apkovl/ - Persistent overlay files"
    backups: "/mnt/udos/backups/ - System backups"
    logs: "/mnt/udos/logs/ - Application logs"
    data: "/mnt/udos/data/ - User/application data"
  apkovl_strategy: |
    Alpine diskless mode stores persistent system configuration in apkovl directory.
    On boot, these files are overlayed from UDOS_PERSIST onto the ephemeral root.
    Allows full customization to survive reboots.

supported_hardware:
  primary:
    - "Intel/AMD x86_64 systems (most common)"
    - "GPU: Intel integrated, AMD Radeon (Mesa support)"
    - "Display: Wayland modesetting capable"

  secondary:
    - "ARM (aarch64) - Raspberry Pi 4+, ODROID, etc."
    - "ARM (armhf) - older Raspberry Pi 3, original Pi Zero"

  storage:
    - "USB 3.0+ for Sonic ISO boot"
    - "Internal SSD/HDD for UDOS_PERSIST partition"
    - "Minimum 2GB boot RAM"
    - "Minimum 512MB storage (UDOS_PERSIST)"

boot_methods:
  sonic_usb:
    description: "Boot from Sonic USB (recommended for physical systems)"
    process:
      - "Build with: sonic plan --usb-device /dev/sdX"
      - "Flash with: sonic-stick.sh --manifest config/sonic-manifest.json"
      - "Boot from USB in BIOS/UEFI"
      - "System initializes diskless mode"

  iso_boot:
    description: "Direct ISO boot or VM testing"
    process:
      - "Generate ISO with distribution/remaster_iso.sh"
      - "Boot in VM or physical system"
      - "Diskless mode active"

  local_development:
    description: "macOS/Ubuntu development without physical hardware"
    process:
      - "Run: python3 uDOS.py (TUI simulator)"
      - "Access via: wizard server (localhost:8765)"
      - "Test tier switching and services"

configuration:
  mode_file: "/etc/udos/mode"
  values:
    - "tui - Text User Interface (default)"
    - "gui - Graphical Interface (Wayland + Cage)"

  boot_override: |
    Kernel command-line override via bootloader:
    Add "udos.mode=gui" to GRUB_CMDLINE_LINUX_DEFAULT or equivalent

  environment:
    UDOS_PERSIST: "/mnt/udos (mount point)"
    UDOS_CONFIG: "/etc/udos (config directory)"
    UDOS_PERSIST_DEVICE: "(optional) custom device path"
    XDG_RUNTIME_DIR: "/run/user/1000 (Wayland runtime)"

installation_checklist:
  pre_boot:
    - "[ ] Create UDOS_PERSIST partition on target media"
    - "[ ] Label partition as 'UDOS_PERSIST'"
    - "[ ] Build Sonic ISO with Alpine uDOS base"
    - "[ ] Create bootable USB with Sonic"

  post_boot_tui:
    - "[ ] Boot Alpine into TUI"
    - "[ ] Mount persistence: udos-persist mount"
    - "[ ] Verify: udos-persist check"
    - "[ ] Access uDOS CLI: python3 uDOS.py"

  post_boot_gui:
    - "[ ] Complete TUI setup steps above"
    - "[ ] Install Tauri app: apk add udos-ui"
    - "[ ] Switch tier: udos-tier switch gui"
    - "[ ] Reboot: reboot"
    - "[ ] GUI launches automatically on boot"

maintenance:
  health_checks:
    - "Periodic: udos-persist check"
    - "Automatic: udos-watchdog (monitors crashes)"
    - "Manual: udos-tier status (GUI prerequisites)"

  backup_strategy:
    - "Create: udos-persist backup"
    - "Schedule: Regular backups via cron"
    - "Restore: udos-persist restore <file>"

  recovery:
    - "Automatic: Watchdog fallback to TUI on repeated GUI crashes"
    - "Manual: udos-tier switch tui, then reboot"
    - "Emergency: Boot with udos.mode=tui kernel flag"

testing_matrix:
  physical_hardware:
    - "[ ] x86_64 laptop/desktop"
    - "[ ] Raspberry Pi 4 (aarch64)"
    - "[ ] USB persistence on multiple devices"

  tier_switching:
    - "[ ] Boot → TUI"
    - "[ ] udos-tier switch gui → reboot → GUI"
    - "[ ] Close udos-ui → return to TTY or reboot"
    - "[ ] Hard shutdown during GUI → watchdog recovery"

  persistence:
    - "[ ] Reboot with persistent data intact"
    - "[ ] Disk full scenario handling"
    - "[ ] Backup/restore cycle"

  graphics:
    - "[ ] HDMI/DisplayPort detection"
    - "[ ] Multiple monitor support"
    - "[ ] Resolution scaling"
    - "[ ] Input device handling (keyboard, mouse)"

deprecations:
  removed_from_v1_3_0:
    - "TinyCore (.tcz) extension support → Alpine APK"
    - "multiapp Wayland sessions → single-app Cage mode"
    - "systemd support in core → OpenRC only"

breaking_changes:
  plugin_system: |
    v1.3.3 plugins (.tcz) must be repackaged as Alpine APK.
    See wizard/services/plugin_factory.py APKBuilder for examples.

  service_management: |
    systemd-specific features not available on Alpine.
    Use rc-service and /etc/init.d/ instead.
    See AGENTS.md "Logging Tags" for [LOCAL] service patterns.

forward_compatibility:
  v1_3_5_planned:
    - "Wizard networking standard (Wi-Fi beacon, RadioLink, WireGuard)"
    - "Long-range mesh peering (LoRa/MeshCore)"
    - "Proximity-first trust model"

  future_hardware_targets:
    - "Specific board support packages (Raspberry Pi recovery images)"
    - "Custom firmware distributions"
    - "Hardware-specific optimizations"

documentation:
  primary_references:
    - "/docs/roadmaps/alpine-core.md - Complete architecture spec"
    - "/docs/howto/alpine-install.md - Installation guide"
    - "/docs/decisions/ADR-0003-alpine-linux-migration.md - Design rationale"

  guides:
    - "Tier switching: see udos-tier --help"
    - "Persistence management: see udos-persist --help"
    - "GUI troubleshooting: see udos-gui start [verbose]"
    - "Recovery diagnostics: see udos-watchdog diagnostics"

  package_building:
    - "/distribution/apkbuild/udos-ui/README.md - Tauri app packaging"
    - "/wizard/services/plugin_factory.py - APKBuilder class"
    - "Alpine APKBUILD format: https://wiki.alpinelinux.org/wiki/APKBUILD_Reference"

support_channels:
  issues: "https://github.com/fredporter/uDOS/issues"
  wiki: "/docs/ + /memory/wiki/"
  status: "v1.3.4 provisioning in progress"

license: "MIT"
authors:
  - "uDOS Team"
  - "Alpine Linux community"

sha256_checksums:
  # Generated after release builds complete
  udos-core-alpine: "TBD"
  udos-sonic-iso: "TBD"
  udos-ui-apk-x86_64: "TBD"
  udos-ui-apk-aarch64: "TBD"

## Notes

**Status:** Provisioning in progress
**Next Steps:**
1. Build Tauri app for Alpine target
2. Test persistence partition operations
3. Verify Wayland/Cage integration
4. Validate recovery mechanisms
5. Create physical ISO images

**Key Files:**
- `/distribution/udos/bin/` - executable utilities
- `/distribution/udos/etc/init.d/` - OpenRC service definitions
- `/distribution/apkbuild/udos-ui/` - Tauri APK build configuration
- `/docs/roadmaps/alpine-core.md` - full specification
